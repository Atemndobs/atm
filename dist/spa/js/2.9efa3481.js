(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"04b7":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"constrain q-pa-md"},[n("div",{staticClass:"row q-col-gutter-lg"},[n("div",{staticClass:"col-12 col-sm-8"},[!t.loadingPosts&&t.posts.length?t._l(t.posts,(function(e,o){return n("q-card",{key:e.id,staticClass:"card-post q-mb-md",attrs:{bordered:"",flat:""}},[n("q-item",[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",[n("img",{attrs:{src:s("63d0")}})])],1),n("q-item-section",[n("q-item-label",{staticClass:"text-bold"}),n("q-item-label",{attrs:{caption:""}},[t._v("\n                      "+t._s(e.location)+"\n                    ")])],1)],1),n("q-separator"),n("q-img",{attrs:{src:e.imageUrl}}),n("q-card-section",[n("q-item-section",[n("q-item-label",{staticClass:"text-bold"}),n("q-item-label",{attrs:{caption:""}},[n("q-item",[n("q-item-section",[n("div",[t._v(t._s(e.caption))]),n("div",{staticClass:"text-caption text-grey"},[t._v(t._s(t._f("niceDate")(e.created_at)))])]),n("q-item-section",[n("div",[t._v(t._s(e.new_comment.comment))]),n("div",{staticClass:"text-caption text-grey"},[t._v(t._s(t._f("niceDate")(e.created_at)))])]),n("q-btn",{attrs:{rounded:"",dense:"",label:0===e.likes.likes_count?"":e.likes.likes_count},on:{click:function(s){return t.submitLike(e)}}},[n("q-icon",{attrs:{name:e.likes.icon_class,color:e.likes.is_liked?"red":"",size:"25px",rounded:""}})],1)],1),n("div",{staticClass:"row justify-center q-ma-md"},[n("q-input",{staticClass:"col col-sm-6",attrs:{label:"add comment",dense:""},on:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:(s.preventDefault(),t.addComment(t.commentBox,e))}},model:{value:t.commentBox,callback:function(e){t.commentBox=e},expression:"commentBox"}})],1)],1)],1),n("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[n("q-expansion-item",{attrs:{"expand-separator":"",icon:"eva-message-circle-outline",label:"View Comments",caption:e.comments_count+" comments","default-closed":""}},t._l(e.comments,(function(e,s){return n("q-chat-message",{key:e.id,attrs:{name:e.commenter.name,avatar:e.commenter.photo_url,text:[e.comment],size:"6",stamp:t._f("niceDate")(e.created_at),"text-color":"white","bg-color":"primary"}})})),1)],1)],1)],1)})):t.loadingPosts||t.posts.length?[n("div",{staticClass:"q-pa-md"},[n("q-card",[n("q-item",[n("q-item-section",{attrs:{avatar:""}},[n("q-skeleton",{attrs:{type:"QAvatar",animation:"fade",size:"40"}})],1),n("q-item-section",[n("q-item-label",[n("q-skeleton",{attrs:{type:"text"}})],1),n("q-item-label",{attrs:{caption:""}},[n("q-skeleton",{attrs:{type:"text"}})],1)],1)],1),n("q-skeleton",{attrs:{height:"200px",square:""}}),n("q-card-actions",{staticClass:"q-gutter-md",attrs:{align:"right"}},[n("q-skeleton",{attrs:{type:"QBtn"}}),n("q-skeleton",{attrs:{type:"QBtn"}})],1)],1)],1)]:[n("h5",{staticClass:"text-center text-grey"},[t._v("\n              No POSTS HERE\n            ")])]],2),n("div",{staticClass:"col-4 large-screen-only"},[n("q-item",{staticClass:"fixed"},[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{size:"48px"}},[n("img",{attrs:{src:s("63d0")}})])],1),n("q-item-section",[n("q-item-label",{staticClass:"text-bold"},[t._v("atem__ndobs")]),n("q-item-label",{attrs:{caption:""}},[t._v("\n                   "+t._s(this.$auth.user()?this.$auth.user().name:"Atemkeng")+"\n                ")])],1)],1)],1)])])},o=[],a=(s("7db0"),s("4160"),s("c975"),s("d81d"),s("26e9"),s("fb6a"),s("4fad"),s("b64b"),s("159b"),s("278c")),i=s.n(a),c=s("b178"),r=s("bc3a"),l=s.n(r),m=s("5638"),d={name:"Page",data:function(){return{posts:[],commentBox:"",loadingPosts:!1,totalLikes:"",isLiked:!1,reactionType:"eva-heart-outline",cars:[]}},filters:{niceDate:function(t){return c["c"].formatDate(t,"MMMM D h:mmA")},reverse:function(t){return t.slice().reverse()}},methods:{findPost:function(){var t=11;Object.entries(this.posts).forEach((function(e){var s=i()(e,2),n=(s[0],s[1]);n.id===t&&console.log("ATEETET")}))},getPosts:function(){var t=this;this.loadingPosts=!0,this.$axios.get("".concat("https://atemkeng.com/api","/posts")).then((function(e){if(t.posts=e.data.data.reverse(),t.$auth.check())for(var s=function(s){t.posts[s].comments=e.data.data[s].comments.reverse();var n=e.data.data[s].reactions,o=Object.keys(n).map((function(t){return n[t]})),a=o.find((function(n){return n.reacter_id===t.$auth.user().id&&n.reactant_id===e.data.data[s].id}));a&&(t.posts[s].likes.icon_class="eva-heart",t.posts[s].likes.is_liked=!0)},n=0;n<t.posts.length;n++)s(n);t.loadingPosts=!1})).catch((function(e){console.log(e),t.$q.dialog({title:"Error",message:"Oops something went wrong, pls contact Atem"}),t.loadingPosts=!1}))},submitLike:function(t){var e=this;if(!this.$auth.check())return this.$q.dialog({message:"You need to Login Before you can Like"}),this.$router.push("/login"),void console.log({Error:"You need to log in to react to a post"});var s=this.$auth.user().id,n="https://atemkeng.com/api/posts/like/"+t.id,o={user_id:s,type:"Like",post:t};l.a.post(n,o).then((function(s){var n=e.posts.indexOf(t),o=s.data.data.likes.reaction_type;"Like"===o?(e.posts[n].likes.icon_class="eva-heart",e.posts[n].likes.is_liked=!0):(e.posts[n].likes.icon_class="eva-heart-outline",e.posts[n].likes.is_liked=!1,e.reactionType="eva-heart-outline"),e.posts[n].likes.likes_count=s.data.data.likes.likes_count})).catch((function(t){console.log(t)}))},addComment:function(t,e){var s=this;if(!this.$auth.check())return this.$q.dialog({message:"You need to Login Before you can Like"}),this.$router.push("/login"),void console.log({Error:"You need to log in to react to a post"});var n=this.$auth.user().id,o="https://atemkeng.com/api/posts/comment/"+e.id,a={user_id:n,comment:t,post:e};l.a.post(o,a).then((function(t){var n=s.posts.indexOf(e),o=t.data.data.comments.length;s.posts[n].new_comment=t.data.data.new_comment,s.posts[n].comments_count=o,s.posts[n].comments.unshift(t.data.data.new_comment),s.commentBox=""})).catch((function(t){console.log(t)}))},filterObj:function(t,e){var s,n={};for(s in t)t.hasOwnProperty(s)&&e(s,t[s])&&(n[s]=t[s]);return n},pusherData:function(){var t=new Pusher("8643c99a8b00ff38c513",{cluster:"eu"}),e=this,s=t.subscribe("comment-channel");s.bind("App\\Events\\CommentCreatedEvent",(function(t){console.log("COMMING FROM PUSSHER ===================="),JSON.stringify(t),Object.entries(e.posts).forEach((function(e){var s=i()(e,2),n=s[0],o=s[1];if(o.id===t.post_id){parseInt(n);o.comments_count=t.comments_count,o.new_comment=t.new_comment,o.comments.unshift(t.new_comment),console.log(t)}}))}))},pushEcho:function(){window.Echo=new m["a"]({broadcaster:"pusher",key:"local",cluster:"local",forceTLS:!1,wsHost:window.location.hostname,wsPort:6001,disableStats:!0});var t=this,e=window.Echo.channel("comment-channel");e.listen(".App\\Events\\CommentCreatedEvent",(function(e){JSON.stringify(e),Object.entries(t.posts).forEach((function(s){var n=i()(s,2),o=(n[0],n[1]),a=parseInt(e.new_comment.commenter_id),c=parseInt(t.$auth.user().id);a!==c&&o.id===e.post_id&&(o.comments_count=e.comments_count,o.new_comment=e.new_comment,o.comments.unshift(e.new_comment))}))}));var s=window.Echo.channel("like-channel");s.listen(".App\\Events\\LikeCreatedEvent",(function(e){JSON.stringify(e),Object.entries(t.posts).forEach((function(s){var n=i()(s,2),o=(n[0],n[1]);parseInt(e.post.reacter_id),parseInt(t.$auth.user().id);if(o.id===e.post.id){var a=t.posts.indexOf(o);t.posts[a].likes.likes_count=e.post.likes.likes_count}}))}))},updateReaction:function(t,e,s){}},created:function(){this.getPosts()},mounted:function(){this.$auth.user()||this.pushEcho()}},u=d,p=(s("0be4"),s("2877")),h=Object(p["a"])(u,n,o,!1,null,"695eb66c",null);e["default"]=h.exports},"0be4":function(t,e,s){"use strict";s("3a8d")},"3a8d":function(t,e,s){},"63d0":function(t,e,s){t.exports=s.p+"img/avat_atem.79940818.png"}}]);